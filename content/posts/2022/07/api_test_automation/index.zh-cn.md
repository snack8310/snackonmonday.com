---
title: "接口自动化测试-女神的圣斗士"
date: 2022-07-20T17:25:51+08:00
draft: true
---

## 存在问题
1. 写了很多人都知道的废话。这些废话不要，要删掉。例如自动化测试价值。大家都想的出来，不需要写。
2. 可以提一下UI和接口的区别，主要是成本和收益，有部分人没有思路。
3. 缺少实现细节。具体的实现，遇到的问题。这部分别人不了解。
4. 缺少结果的评价。这部分别人不了解。



### 测试价值
测试很难做，因为测试的行为是与功能产出相反，并不具备做出一个事情的驱动力。
测试也很难衡量价值，因为测试自身不直接产生价值。依赖系统发现的bug数量，也许可以评价系统质量，但无法很好的评价测试价值。

善战者无赫赫之功。
非要找到一个测试价值的切入点，比较合适的方式可能是，
- 在某一个质量标准下的产品迭代速度。

能不能“保障”越来越快的迭代下不出问题，这是测试视角的价值。

如何“保障”？
是人就会出错，系统也会出错，越复杂的系统越容易出错。
想给人承诺，则需要底线的保障。
就像法律是道德的底线一样，想要维护治安，需要有一道不可逾越的法律保障。
测试就像警察一样，是维护系统质量的底线。

### 测试常见的问题
- 功能的改造，即使只增加了日志监控，也需要比较全面回归测试。开发与测试时间比不合理。
- 某一个功能的上线，莫名引起了其他功能的错误。
- 业务上线周期长。测试环境验证的内容，也许要在回归环境，预发环境再次执行。
- 一些批量的功能，类似系统对账，存在大量并发，或者时间长的情况下会出现的问题。
  - 性能测试不足，线上产生时效性的投诉。
  - 并发环境下，出现的数据不一致问题，验证不到。

这些常见的问题，要怎么解决。如何让系统警察更有效率的保障？
其中之一的手段是自动化测试。
行业里更细分的话，一般有两种：
1. 接口自动化
2. UI自动化
上述大部分内容，属于接口自动化能解决的问题。

### 自动化测试价值

自动化测试能做什么？
套用圣斗士星矢里的话：
同样的招式，不要对一个女神的圣斗士使用两次。

自动化测试可以帮我们保障测试过的内容，不会再出错。

### 优点
1. 人会疏忽，犯错，机器不会。
2. 解决人力并不好覆盖的点，例如性能测试和压力测试。
3. 反复多次的重复测试。
4. 效率高。

### 缺点
1. 对人员要求高。
2. 测试要件准备困难。
3. 依赖业务接口的抽象能力，决定测试接口的重构频率。

### 单元测试 还是 接口测试
- 单元测试，是开发内部的。
- 接口测试，是测试视角。
这两者都可以，根据各自情况的选择，更推荐的是接口测试。

很多面向测试编程的项目，最终容易流产，实施不下去。很多的原因是单元功能变化太多，一个小功能的调整，造成了大量测试用例的修改。久而久之，很难坚持下去。
相对来说，面向业务接口的测试，变更的几率相对更少，更稳定。可以把业务功能做成黑盒子，业务数据验证也通过接口实施，会进一步减少测试用例变更的成本。

### 实施成本
自动化测试框架有很多种，例如Selenium， Allure，很多大厂也有自研的。
拿Jenkins+Allure+Python为例：
- Jenkins+Allure的环境，无论是容器化还是物理机。
- 部署系统的钩子
- 功能测试脚本
- 能写脚本的人员

#### 实施手段
- 面向接口开发
- 面向接口写测试用例
- UI测试与接口测试隔离

#### 冒烟测试
测试环节更友善，失败率低。
一个不高的开发质量，会造成大量的测试时间浪费，从构建数据，测试验证，投入一次测试资源。失败意味着测试时间的浪费，后面影响其他功能的迭代。

- 开发人员通过冒烟测试
- 测试人员完善冒烟测试


#### 实施环节
- 开发环节通过冒烟测试
- 固定分支部署流程后自动化回归测试
- 约定时间执行压力测试。

### 如何评估收益
测试自动化是个随着功能覆盖度上升，效能逐渐提升的。
项目初期会面临时间成本变长的问题，比单纯的测试，大量的数据准备的代码落地要求，要远超过单纯的功能测试人工操作时间。
1. 测试开发比。
2. 测试事故率。